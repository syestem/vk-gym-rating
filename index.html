<script>
  vkBridge.send('VKWebAppInit');

  const SHEET_URL =
    'https://docs.google.com/spreadsheets/d/1fz_CeBp5yXH3qwvgYGQXY77nHZXoq3JMn6BqPZQ--Og/export?format=csv';

  fetch(SHEET_URL)
    .then(r => r.text())
    .then(text => {
      const rows = text.trim().split('\n').slice(1);
      const tbody = document.querySelector('#rating tbody');

      rows.forEach((row, index) => {
        if (!row.trim()) return;

        const parts = row.split(';');
        if (parts.length < 5) return;

        const [vkUrl, name, gym, pool, total] = parts;

        const tr = document.createElement('tr');
        tr.innerHTML = `
          <td>${index + 1}</td>
          <td><a href="${vkUrl}" target="_blank">${name}</a></td>
          <td>${gym}</td>
          <td>${pool}</td>
          <td><b>${total}</b></td>
        `;
        tbody.appendChild(tr);
      });
    })
    .catch(err => console.error('CSV error:', err));
</script>
